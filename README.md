# SemAS
We present an advanced measure – a **Semantic Alignment Scoring (SemAS) tool** – 
that computes the alignment of textual explanations with clinical encounter data. 
We posit that an explanation used to aid patient management must be
contextualized by encounter data. Thus, SemAS plays a crucial role
in evaluating the clinical usefulness of explanations generated by a Clinical Decision Support System.

The calculation of the semantic alignment score relies on identifying meaningful
information in encounter data and explanations, which are captured as relations
between medical concepts. It takes as input the encounter data and the explanation
for a specific action from the management plan, and returns
a numerical score in the range of [0, 1].

The computational pipeline involves three main steps:
### 1. **Relation extraction**:
   Specifically, an LLM is prompted to extract all possible relations between medical concepts, con-
strained by a predefined set of relation types.
> Step 1 script: [relation_extraction](https://github.com/laurabergomi/SemAS/blob/main/relation_extraction.py)

   
### 2. **Generation of embeddings for extracted relations**: 
We use the PubMedBERT base model fine-tuned with Sentence-Transformers, applied
to each of the extracted relations.
   
### 3. **Computation of the alignment score**: 
We adopt a semantic search approach in which the cosine similarity between the embedding of each rela-
tion in the explanation and the embeddings of all relations in the encounter
data is calculated. Then, the 90th percentile of the resulting similarity dis-
tribution is identified as the semantic search score and stored. 
   Finally, the semantic
alignment score is calculated by averaging the semantic search scores for
specific relations obtained from the explanation.
> Step 2 & 3 script: [score_computation](https://github.com/laurabergomi/SemAS/blob/main/score_computation.py)